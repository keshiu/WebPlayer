"use strict";var main=function(){var n,e,t,o,a,i,r={},c=null,u=512,l=120,f=function(n,e){var t=document.createElement("canvas");return t.width=n,t.height=e,t},d=function(){r=this.files,i=r[0]},s=function(n,e){var t=new FileReader;t.onload=function(){var n=t.result;e(n)},t.onerror=function(e){e.target.error.code==e.target.error.NOT_READABLE_ERR&&alert("Failed to read file: "+n.name)},t.readAsArrayBuffer(n)},m=function(){function n(){e=requestAnimationFrame(n),a.getByteTimeDomainData(u),c.fillStyle="rgb(255, 255, 255)",c.fillRect(0,0,t,i),c.lineWidth=2,c.strokeStyle="rgb(47, 79, 79)",c.beginPath();for(var l=1*t/r,f=0,d=0;r>d;d++){var s=u[d]/128,m=s*i/2;0===d?c.moveTo(f,m):c.lineTo(f,m),f+=l}c.lineTo(o.width,o.height/2),c.stroke()}var e,t=o.width,i=o.height,r=a.frequencyBinCount,u=new Uint8Array(r);a.fftSize=2048,c.clearRect(0,0,t,i),n()},p=function(o){n.decodeAudioData(o,function(o){e=o,t=n.createBufferSource(),a=n.createAnalyser(),t.buffer=e,t.loop=!1,t.connect(a),a.connect(n.destination),m(),h()},function(n){console.log("Error decoding file "+n)})},h=function(){t.start(0)},g=function(){t.stop(0)};window.addEventListener("load",function(){try{window.AudioContext=window.AudioContext||window.webkitAudioContext,n=new AudioContext,o=f(u,l),$("#visualField").append(o),c=o.getContext("2d")}catch(e){alert("Opps.. Your browser do not support audio API")}},!1);var y=document.getElementById("download");y.addEventListener("change",d,!1),$("#play").click(function(){s(i,p)}),$("#stop").click(function(){g()})};$(document).ready(main);
